webpackJsonp([7],{"1/Ik":function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var o={data:function(){return{statusOptions:[{value:0,label:"启用"},{value:1,label:"禁用"}],roleTypeOptions:[],tableData:[],total:0,searchForm:{status:"",roleCode:"",mobilePhoneLike:"",userNameLike:"",currentPage:1,pageSize:10},addFormDialog:{visible:!1,title:"",isAdd:"",formLabelWidth:"100px",formInputWidth:"300px",form:{id:"",userName:"",password:"",portrait:"",nickName:"",mobilePhone:"",email:"",roleCode:"",description:""}}}},mounted:function(){this.handleSearch(),this.handleRoleTypeOptions()},methods:{handleSearch:function(){var e=this,a=e.$api.userList;e.$axiosPOST(a,e.searchForm,function(a){e.tableData=a.data.list,e.total=a.data.total})},handleShowAddForm:function(e){void 0===e||null===e?(this.addFormDialog.title="添加用户",this.addFormDialog.isAdd=!0,this.addFormDialog.form={id:"",userName:"",password:"",portrait:"",nickName:"",mobilePhone:"",email:"",roleCode:"",description:""}):(this.addFormDialog.title="修改用户",this.addFormDialog.isAdd=!1,this.addFormDialog.form={id:e.id,userName:e.userName,password:e.password,portrait:e.portrait,nickName:e.nickName,mobilePhone:e.mobilePhone,email:e.email,roleCode:e.roleCode,description:e.description}),this.addFormDialog.visible=!0},handleAddUser:function(){var e=this,a=e.$api.register;e.$axiosPOST(a,this.addFormDialog.form,function(a){e.$message("添加成功"),e.handleSearch(),e.addFormDialog.visible=!1})},handleDeleteUser:function(e){var a=this;this.$alert("删除后不可恢复！确定删除？","警告",{type:"warning"}).then(function(t){var o=a.$api.userDelete+"/"+e;a.$axiosPOST(o,{},function(e){a.$message("删除成功"),a.handleSearch()})})},handleUpdateUser:function(){var e=this,a=e.$api.userUpdate;e.$axiosPOST(a,this.addFormDialog.form,function(a){e.$message("修改成功"),e.handleSearch(),e.addFormDialog.visible=!1})},handleAvatarSuccess:function(e,a){this.addFormDialog.form.portrait=URL.createObjectURL(a.raw),alert(this.addFormDialog.form.portrait)},beforeAvatarUpload:function(e){var a="image/jpeg"===e.type,t=e.size/1024/1024<2;return a||this.$message.error("上传头像图片只能是 JPG 格式!"),t||this.$message.error("上传头像图片大小不能超过 2MB!"),a&&t},changeUpload:function(e,a){var t=this;if(window.FileReader){var o=new FileReader;console.log(e);var l=e.raw;/^image\//.test(l.type)?(o.onload=function(e){t.addFormDialog.form.portrait=e.target.result},o.readAsDataURL(l)):t.$message("请确认图片格式是否正确")}else t.$message("请使用谷歌浏览器")},handleRoleTypeOptions:function(){var e=this,a=e.$api.roleListAll;e.$axiosPOST(a,{},function(a){console.log(a),a.data.forEach(function(a){e.roleTypeOptions.push({value:a.roleCode,label:a.roleName})}),console.log(e.roleTypeOptions)})},handleChangeStatus:function(e,a){var t=this,o=t.$api.userUpdateStatus+"/"+a+"/"+e;t.$axiosPOST(o,{},function(a){t.$message(0===e?"已启用":"已禁用"),t.handleSearch()})},handleClickPage:function(e){this.searchForm.currentPage=e,this.handleSearch()},handleSizeChange:function(e){this.searchForm.pageSize=e,this.handleSearch()},dateFormatter:function(e,a){var t=e[a.property];return void 0===t||null===t?"":this.$formatDate(new Date(t),"YYYY-MM-DD HH:mm:ss")}}},l={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"page-body"},[t("div",{staticClass:"page-header"},[t("el-breadcrumb",[t("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[t("i",{staticClass:"fa fa-home"})]),e._v(" "),t("el-breadcrumb-item",[e._v("用户管理")])],1)],1),e._v(" "),t("div",{staticClass:"box"},[t("el-select",{staticStyle:{width:"150px"},attrs:{size:"small",clearable:"",placeholder:"角色"},model:{value:e.searchForm.roleCode,callback:function(a){e.$set(e.searchForm,"roleCode",a)},expression:"searchForm.roleCode"}},e._l(e.roleTypeOptions,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),t("el-select",{staticStyle:{width:"150px"},attrs:{size:"small",clearable:"",placeholder:"状态"},model:{value:e.searchForm.status,callback:function(a){e.$set(e.searchForm,"status",a)},expression:"searchForm.status"}},e._l(e.statusOptions,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),t("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"手机号",size:"small",clearable:""},model:{value:e.searchForm.mobilePhoneLike,callback:function(a){e.$set(e.searchForm,"mobilePhoneLike",a)},expression:"searchForm.mobilePhoneLike"}}),e._v(" "),t("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"用户名",size:"small",clearable:""},model:{value:e.searchForm.userNameLike,callback:function(a){e.$set(e.searchForm,"userNameLike",a)},expression:"searchForm.userNameLike"}}),e._v(" "),t("p"),e._v(" "),t("m-button",{attrs:{type:"info",size:"small"},on:{click:e.handleSearch}},[t("i",{staticClass:"fa fa-search"},[e._v(" 搜索")])]),e._v(" "),t("m-button",{attrs:{type:"info",size:"small"},on:{click:function(a){e.handleShowAddForm(null)}}},[t("i",{staticClass:"fa fa-plus"},[e._v(" 添加")])]),e._v(" "),t("p"),e._v(" "),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[t("el-table-column",{attrs:{prop:"id",label:"ID",align:"center",width:"50px"}}),e._v(" "),t("el-table-column",{attrs:{prop:"userName",label:"用户名",width:"120"}}),e._v(" "),t("el-table-column",{attrs:{prop:"nickName",label:"昵称",width:"150"}}),e._v(" "),t("el-table-column",{attrs:{prop:"mobilePhone",label:"电话",width:"150"}}),e._v(" "),t("el-table-column",{attrs:{prop:"roleCode",label:"角色",width:"150"}}),e._v(" "),t("el-table-column",{attrs:{prop:"lastLoginTime",formatter:e.dateFormatter,label:"最近登陆时间",width:"200"}}),e._v(" "),t("el-table-column",{attrs:{label:"账户状态",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-switch",{attrs:{"active-value":0,"inactive-value":1},on:{change:function(t){e.handleChangeStatus(t,a.row.id)}},model:{value:a.row.status,callback:function(t){e.$set(a.row,"status",t)},expression:"scope.row.status"}})]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"操作",fixed:"right",width:"150"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text"},on:{click:function(t){e.handleShowAddForm(a.row)}}},[e._v("编辑")]),e._v(" "),t("el-button",{attrs:{type:"text"},on:{click:function(t){e.handleDeleteUser(a.row.id)}}},[e._v("删除")])]}}])})],1),e._v(" "),t("p"),e._v(" "),t("el-pagination",{attrs:{background:"","current-page":e.searchForm.currentPage,"page-sizes":[10,20,30,40],"page-size":e.searchForm.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleClickPage}})],1),e._v(" "),t("el-dialog",{attrs:{title:e.addFormDialog.title,visible:e.addFormDialog.visible},on:{"update:visible":function(a){e.$set(e.addFormDialog,"visible",a)}}},[t("el-form",{ref:"form",attrs:{"label-width":e.addFormDialog.formLabelWidth,model:e.addFormDialog.form}},[t("el-form-item",{attrs:{label:"用户名"}},[t("el-input",{style:{width:this.addFormDialog.formInputWidth},attrs:{size:"small",autocomplete:"off",disabled:!e.addFormDialog.isAdd},model:{value:e.addFormDialog.form.userName,callback:function(a){e.$set(e.addFormDialog.form,"userName",a)},expression:"addFormDialog.form.userName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"昵称"}},[t("el-input",{style:{width:this.addFormDialog.formInputWidth},attrs:{size:"small",autocomplete:"off"},model:{value:e.addFormDialog.form.nickName,callback:function(a){e.$set(e.addFormDialog.form,"nickName",a)},expression:"addFormDialog.form.nickName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"密码"}},[t("el-input",{style:{width:this.addFormDialog.formInputWidth},attrs:{size:"small",autocomplete:"off",disabled:!e.addFormDialog.isAdd},model:{value:e.addFormDialog.form.password,callback:function(a){e.$set(e.addFormDialog.form,"password",a)},expression:"addFormDialog.form.password"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"头像"}},[t("el-upload",{staticClass:"avatar-uploader",attrs:{action:"https://jsonplaceholder.typicode.com/posts/","show-file-list":!1,"on-change":e.changeUpload,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.addFormDialog.form.portrait?t("img",{staticClass:"avatar",attrs:{src:e.addFormDialog.form.portrait}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),t("el-form-item",{attrs:{label:"手机"}},[t("el-input",{style:{width:this.addFormDialog.formInputWidth},attrs:{size:"small",autocomplete:"off"},model:{value:e.addFormDialog.form.mobilePhone,callback:function(a){e.$set(e.addFormDialog.form,"mobilePhone",a)},expression:"addFormDialog.form.mobilePhone"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"邮箱"}},[t("el-input",{style:{width:this.addFormDialog.formInputWidth},attrs:{size:"small",autocomplete:"off"},model:{value:e.addFormDialog.form.email,callback:function(a){e.$set(e.addFormDialog.form,"email",a)},expression:"addFormDialog.form.email"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"用户类型"}},[t("el-select",{style:{width:this.addFormDialog.formInputWidth},attrs:{clearable:"",placeholder:"角色"},model:{value:e.addFormDialog.form.roleCode,callback:function(a){e.$set(e.addFormDialog.form,"roleCode",a)},expression:"addFormDialog.form.roleCode"}},e._l(e.roleTypeOptions,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),t("el-form-item",{attrs:{label:"个人简介"}},[t("el-input",{style:{width:this.addFormDialog.formInputWidth},attrs:{size:"small",type:"textarea",rows:2,placeholder:"请输入内容",autocomplete:"off"},model:{value:e.addFormDialog.form.description,callback:function(a){e.$set(e.addFormDialog.form,"description",a)},expression:"addFormDialog.form.description"}})],1)],1),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(a){e.addFormDialog.visible=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){e.addFormDialog.isAdd?e.handleAddUser():e.handleUpdateUser()}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var r=t("C7Lr")(o,l,!1,function(e){t("hFGB")},null,null);a.default=r.exports},hFGB:function(e,a){}});
//# sourceMappingURL=7.a4736feb317f74fd5d9d.js.map